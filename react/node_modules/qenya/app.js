'use strict';exports.__esModule = true;var _regenerator = require('babel-runtime/regenerator');var _regenerator2 = _interopRequireDefault(_regenerator);var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);var start = function () {var _ref = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(










  function _callee3(options) {var _this = this;var app, mdb;return _regenerator2.default.wrap(function _callee3$(_context3) {while (1) {switch (_context3.prev = _context3.next) {case 0:
            (0, _config.setConfig)(options.config);

            app = new _koa2.default();

            app.use(_logger2.default);

            app.use(_render2.default);

            // db engine
            if (!(_config2.default.engine === 'tingodb')) {_context3.next = 8;break;}
            app.use((0, _tingodb2.default)());_context3.next = 12;break;case 8:_context3.next = 10;return (

              (0, _mongodb2.default)());case 10:mdb = _context3.sent;
            app.use(mdb);case 12:


            app.use((0, _koaViews2.default)(_path2.default.resolve(__dirname, 'static'), {
              map: { html: 'swig' } }));


            _router2.default.get('/resetapi', function () {var _ref2 = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(ctx) {return _regenerator2.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:if (!
                        options.api) {_context.next = 3;break;}_context.next = 3;return options.api.reset();case 3:
                        ctx.Render.success('');case 4:case 'end':return _context.stop();}}}, _callee, _this);}));return function (_x2) {return _ref2.apply(this, arguments);};}());


            if (options.route) options.route(_router2.default);

            _router2.default.get('/static/*', function () {var _ref3 = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(ctx) {return _regenerator2.default.wrap(function _callee2$(_context2) {while (1) {switch (_context2.prev = _context2.next) {case 0:_context2.next = 2;return (
                          (0, _koaSend2.default)(ctx, ctx.path, { root: __dirname }));case 2:case 'end':return _context2.stop();}}}, _callee2, _this);}));return function (_x3) {return _ref3.apply(this, arguments);};}());


            app.use(_router2.default.routes());

            app.listen(options.port, function () {
              console.log('qenya server running on http://localhost:' + options.port);
            });case 18:case 'end':return _context3.stop();}}}, _callee3, this);}));return function start(_x) {return _ref.apply(this, arguments);};}();var _path = require('path');var _path2 = _interopRequireDefault(_path);var _koa = require('koa');var _koa2 = _interopRequireDefault(_koa);var _koaViews = require('koa-views');var _koaViews2 = _interopRequireDefault(_koaViews);var _koaSend = require('koa-send');var _koaSend2 = _interopRequireDefault(_koaSend);var _config = require('./config');var _config2 = _interopRequireDefault(_config);var _tingodb = require('./middlewares/tingodb');var _tingodb2 = _interopRequireDefault(_tingodb);var _mongodb = require('./middlewares/mongodb');var _mongodb2 = _interopRequireDefault(_mongodb);var _logger = require('./middlewares/logger');var _logger2 = _interopRequireDefault(_logger);var _render = require('./middlewares/render');var _render2 = _interopRequireDefault(_render);var _router = require('./router');var _router2 = _interopRequireDefault(_router);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}exports.default =


{
  start: start };
//# sourceMappingURL=app.js.map