'use strict';exports.__esModule = true;var _regenerator = require('babel-runtime/regenerator');var _regenerator2 = _interopRequireDefault(_regenerator);var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);var _koaRouter = require('koa-router');var _koaRouter2 = _interopRequireDefault(_koaRouter);
var _koaBodyparser = require('koa-bodyparser');var _koaBodyparser2 = _interopRequireDefault(_koaBodyparser);
var _graphql = require('graphql');
var _graphql2 = require('../graphql');var _graphql3 = _interopRequireDefault(_graphql2);
var _schemas = require('../models/schemas');function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}

var router = new _koaRouter2.default();

router.get('/graphql/:query', function () {var _ref = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(ctx) {var query, schemas;return _regenerator2.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:
            query = ctx.params.query;_context.next = 3;return (
              (0, _schemas.getAll)(ctx.db()));case 3:schemas = _context.sent;_context.next = 6;return (
              (0, _graphql.graphql)((0, _graphql3.default)(ctx.db('data'), schemas), query));case 6:ctx.body = _context.sent;case 7:case 'end':return _context.stop();}}}, _callee, undefined);}));return function (_x) {return _ref.apply(this, arguments);};}());


router.post('/graphql', (0, _koaBodyparser2.default)(), function () {var _ref2 = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(ctx) {var body, schemas;return _regenerator2.default.wrap(function _callee2$(_context2) {while (1) {switch (_context2.prev = _context2.next) {case 0:
            body = ctx.request.body;_context2.next = 3;return (
              (0, _schemas.getAll)(ctx.db()));case 3:schemas = _context2.sent;_context2.next = 6;return (
              (0, _graphql.graphql)(
              (0, _graphql3.default)(ctx.db('data'), schemas),
              body.query,
              null,
              null,
              body.variables));case 6:ctx.body = _context2.sent;case 7:case 'end':return _context2.stop();}}}, _callee2, undefined);}));return function (_x2) {return _ref2.apply(this, arguments);};}());exports.default =



router;
//# sourceMappingURL=graphql.js.map