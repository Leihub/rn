{"version":3,"sources":["../../server/middlewares/tingodb.js"],"names":["engine","dbs","qenya","Db","tingo","data","ObjectID","ctx","next","db","path"],"mappings":";;;;;AAKe,YAAY;AACzB,MAAMA,SAAS,uBAAQ,EAAR,CAAf;;AAEA,MAAMC,MAAM;AACVC,WAAO,IAAIF,OAAOG,EAAX,CAAc,iBAAOC,KAAP,CAAaF,KAA3B,EAAkC,EAAlC,CADG;AAEVG,UAAM,IAAIL,OAAOG,EAAX,CAAc,iBAAOC,KAAP,CAAaC,IAA3B,EAAiC,EAAjC,CAFI,EAAZ;;;AAKA,6BAAYL,OAAOM,QAAnB;;AAEA,kBAAM,CAAC,iBAAOF,KAAP,CAAaF,KAAd,EAAqB,iBAAOE,KAAP,CAAaC,IAAlC,CAAN;;AAEA,4FAAO,iBAAgBE,GAAhB,EAAqBC,IAArB;AACLD,kBAAIE,EAAJ,GAAS,iBAACC,IAAD,uEAAQ,OAAR,QAAoBT,IAAIS,IAAJ,CAApB,EAAT,CADK;AAECF,sBAFD,gEAAP;;AAID,C,CArBD,kC,iDACA,mC,+CACA,6CACA,mC","file":"tingodb.js","sourcesContent":["import tingodb from 'tingodb'\nimport config from '../config'\nimport { setObjectID } from '../utils/objectId'\nimport { mkDir } from '../utils/dir'\n\nexport default function () {\n  const engine = tingodb({})\n\n  const dbs = {\n    qenya: new engine.Db(config.tingo.qenya, {}),\n    data: new engine.Db(config.tingo.data, {}),\n  }\n\n  setObjectID(engine.ObjectID)\n\n  mkDir([config.tingo.qenya, config.tingo.data])\n\n  return async function (ctx, next) {\n    ctx.db = (path = 'qenya') => dbs[path]\n    await next()\n  }\n}\n\n"]}