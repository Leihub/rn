'use strict';exports.__esModule = true;var _extends2 = require('babel-runtime/helpers/extends');var _extends3 = _interopRequireDefault(_extends2);var _promise = require('babel-runtime/core-js/promise');var _promise2 = _interopRequireDefault(_promise);exports.





getAll = getAll;exports.





insertApi = insertApi;exports.









updateApi = updateApi;exports.










getOne = getOne;exports.





removeApi = removeApi;var _model = require('../utils/model');var _objectId = require('../utils/objectId');var _objectId2 = _interopRequireDefault(_objectId);var _config = require('../config');var _config2 = _interopRequireDefault(_config);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}var API_NAME = 'api';function getAll(db) {var query = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};var sort = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : { _id: -1 };return new _promise2.default(function () {db.collection(API_NAME).find(query).sort(sort).toArray(_model.callback.apply(undefined, arguments));});}function insertApi(db, model) {return new _promise2.default(function (resolve, reject) {db.collection(API_NAME).insert((0, _extends3.default)({}, model, { _id: (0, _objectId2.default)() }), function (err, result) {if (err) reject(err);if (_config2.default.engine === 'tingodb') resolve(result);else resolve(result.ops);});});}function updateApi(db, model) {var id = (0, _objectId2.default)(model._id);return new _promise2.default(function (resolve, reject) {db.collection(API_NAME).update({ _id: id }, { $set: model }, function (err) {if (err) reject(err);else resolve([model]);});});}function getOne(db, query) {return new _promise2.default(function () {db.collection(API_NAME).findOne(query, _model.callback.apply(undefined, arguments));});}function removeApi(db, id) {
  return new _promise2.default(function (resolve, reject) {
    db.collection(API_NAME).remove({ _id: (0, _objectId2.default)(id) }, function (err, result) {
      if (err) reject(err);
      if (_config2.default.engine === 'tingodb') resolve(result);else
      resolve(result.result.ok);
    });
  });
}
//# sourceMappingURL=api.js.map